
🤔：如何设计一个响应式系统

所谓响应式系统，其实就是将副作用方法和和其依赖的数据进行关联
也就是在副作用中收集依赖数据，当依赖数据发生修改的时候，副作用发生修改

🤔：如何收集依赖数据

副作用中访问依赖数据，那么我们就可以根据 `proxy`的getter 来收集依赖，并将副作用放到一个桶中, 当对数据赋值，触发`setter`就会调用 副作用函数

🤔：副作用中没有的key发生修改不应该触发副作用

定义一个全局 `activeEffect`变量来解决 `effect` 名称固定的问题 
为了解决上面问题，必须修改数据的存储方式
使用 `weakmap` 来存储响应式对象，好处是弱引用，对象销毁，`weakmap`也会销毁
使用 `map` 来存储对象的`key`, 副作用函数依然是`Set`

🤔： 分支和cleanup

某些情况下，副作用有 if 等分支条件语句，会造成副作用和之前的数据不再关联
解决方案，是每次重新执行副作用之前先删除之前的关联，重新建立连接

为了可以清除旧链接，可以采用 给副作用函数 添加`deps`依赖。这样就可以清除

🤔： 如何解决嵌套 `effect`呢

`effect`的嵌套解决方案其实就是创建 `effect`栈

🤔：`effect` 和 `proxy`进行关联之后，是否可以控制`effect`的执行时间或者次数？

为了解决这个问题，我们需要引入 `scheduler`调度器来解决这个问题







